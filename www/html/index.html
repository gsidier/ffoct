<html>
<head>
	<title>FFOCT web lab</title>
</head>
<body>
	<script src='/js/jquery.js'></script>
	<script src='/js/webffoct.js'></script>
	
	<div id=div-menubar>
		<a href="javascript: viewMasters()">main</a>
	</div>
	
	<div id=div-main>
		
		<div class=level1 id=div-masters>
		</div>
		
		<div class=level1 id=div-master-view style="display: none;" >
			<div id=div-master-view-master>
				<img id=img-master-view-master src='' />
			</div>
			<div id=div-master-view-thumbnails>
				<table id=tbl-master-view-thumbnails>
				</table>
			</div>
		</div>
	</div>

	<script language=javascript >
		
		var webffoctGlobals = {
			currentId: undefined
		};
		
		function selectMaster(id) {
			window.alert(id);
			displayMaster(id);
		}
		
		function viewMasters() {
			webffoct.getMasters({
				success: function(data) {
					var masters = data;
					for (var i = 0; i < masters.length; i ++) {
						var id = masters[i].id;
						var props = masters[i].props;
						var tab_props = $("<table></table>");
						for (var prop in props) {
							tab_props.append("<tr><td>{0}</td><td>{1}</td></tr>".format(
								prop, props[prop]
							));
						}
						$("#div-masters").append(
							"<div><table><tr><td><a href='javascript: selectMaster(\"{0}\")'><image id=thumb-{0} src='{1}' /></a></td><td><div>{2}</div></td></tr></table></div>".format(
								id, 
								webffoct.url('masters', id, 'thumbnail'),
								webffoct.outerHtml(tab_props)
							)
						);
					}
				} // success
			}); // webffoct.getMasters
		} // function viewMasters
		
		function displayMaster(id) {
			webffoctGlobals.currentId = id;
			$("#div-main .level1").attr('style', "display: none;");
			$("#div-master-view").attr('style', "display: block;");
			$("#img-master-view-master").attr('src', '/api/masters/{0}/lores'.format(id));
		}
		
		$(document).ready(function () {
			viewMasters();
		});
	</script>
</body>
</html>
